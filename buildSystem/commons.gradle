// v1.0.5

task fetchFromGit(type: Exec) {
    description 'Fetch git.'
    commandLine "git", "fetch"
}

task addToGit(type: Exec) {
    description 'Add git.'
    commandLine "git", "add", "-A"
}

task pushToGit(type: Exec) {
    description 'Push git.'
    commandLine "git", "push"
}

task hola() {
    println("hola")
}

task hola2() {
    println("hola2")
}

task deployLibrary() {
    doFirst {
        println("deployLibrary")
    }
    dependsOn(fetchFromGit)
    dependsOn(addToGit)
    dependsOn(commitToGitWithMessageTask("Library version increased (" + VERSION_NAME + ")"))
    dependsOn(pushToGit)
    dependsOn(createTagToGitTask(VERSION_NAME, ""))
    dependsOn(createPushTagToGitTask(VERSION_NAME))
}

def commitToGitWithMessageTask(message) {
    return tasks.create(name: 'commitToGitWithMessage', type: Exec) {
        description 'Commit git.'
        commandLine "git", "commit", "-m", message
    }
}

def createTagToGitTask(tag, message) {
    return tasks.create(name: 'createTagToGit', type: Exec) {
        description 'Tag git.'
        commandLine "git", "tag", "-a", tag, "-m", message
    }
}

def createPushTagToGitTask(tag) {
    return tasks.create(name: 'pushTagToGit', type: Exec) {
        description 'Push tag to git.'
        commandLine "git", "push", "origin", tag
    }
}

